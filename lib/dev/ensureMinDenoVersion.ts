import { gte, log } from "../deps.ts";

const MIN_DENO_VERSION = "1.24.3";

export function ensureMinDenoVersion() {
  // Check that the minimum supported Deno version is being used.
  if (!Deno.version) return;
  if (!gte(Deno.version.deno, MIN_DENO_VERSION)) {
    let message =
      `Deno version ${MIN_DENO_VERSION} or higher is required. Please update Deno.\n\n`;

    if (Deno.execPath().includes("homebrew")) {
      message +=
        "You seem to have installed Deno via homebrew. To update, run: `brew upgrade deno`\n";
    } else {
      message += "To update, run: `deno upgrade`\n";
    }

    log.error(message);
    Deno.exit(1);
  }
}
