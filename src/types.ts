import { TransformOptions as EsBuildTransformOptions } from "https://deno.land/x/esbuild@v0.12.24/mod.js";

export type ImportMap = { imports: Record<string, unknown> };

export type Navigate = (to: string, opts?: { replace?: boolean }) => void;

export type StartOptions = {
  importmap: string;
  rootDirectory?: string;
  lang?: string;
};

export type TransformOptions = {
  source: string;
  importmap: ImportMap;
  root: string;
  loader?: EsBuildTransformOptions["loader"];
};

export type RenderOptions = {
  root: string;
  importmap: ImportMap;
  request: { url: URL };
  lang: string;

  // Number of bytes of the response to buffer before starting to stream. This
  // allows 500 statuses to be raised, provided the error happens while the
  // response is buffering, rather than streaming:
  bufferSize?: number;

  // Size of the chunk to emit to the connection as the response streams:
  chunkSize?: number;
};

export type Cache = Map<unknown, unknown>;
